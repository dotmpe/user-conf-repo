# ~/.bashrc: executed by bash(1) for non-login shells.
# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)
# for examples [Debian]

# 2006--2024  Berend van Berkum <dev@dotmpe.com>

ENV_SRC="${ENV_SRC:-}~/.bashrc "

# @ Inline: Shell:running-interactively
# If not running interactively, then don't do any dynamic stuff either
case $- in
    *i*) ;;
      *) return;;
esac
test -z "${PS1-}" && {
  return
}
# ;


### Load static helper env
[[ ! ${uc_log-} ]] || {
  . /etc/profile.d/uc-profile.sh || return
  uc_log_init
}


### Run user-profile boot phases
[[ ! ${UC_PROFILE_INIT-} ]] || {

  # Include 'preload' group before Uc init
  uc_profile_boot "$UC_TAB" preload || return

  # Uc env and Ids
  uc_profile_init rc || return
}

$uc_log debug ":user-rc" "Booting user RC session" "$UC_TAB"

uc_profile_boot "$UC_TAB" rc || return


### Command aliases
test -n "${UC_SH_ALIASES:-}" && {
  $uc_log info :user-rc \
    "Shell aliases disabled per config" "Uc-Sh-Aliases:${UC_SH_ALIASES:?}"
} || {
  test ! -e ~/.alias && {
    $uc_log debug :user-rc "No user aliases found" "~/.alias"
  } || {
    $uc_log debug :user-rc "Sourcing user aliases..." "~/.alias"
    ${uc_source:-"."} ~/.alias
  }
}

# This is the last config line for interactive non-login sessions.
# Start non-login session now or let profile handle start login session

shopt -q login_shell && {
    fnmatch "*/.profile *" "$ENV_SRC" ||
      $uc_log error ":user-rc" "Login shell but no profile?!"

    $uc_log info ":user-rc" "Load complete" "~/.bashrc"

  } || {

    $uc_log debug :user-rc "Loaded, starting" "~/.bashrc"
    uc_profile_start
  }

# ex:ft=bash:
